<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docs2PPT | Home</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3f37c9;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #4cc9f0;
            --danger: #f72585;
            --warning: #f8961e;
            --gray: #adb5bd;
            --light-gray: #e9ecef;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light);
            color: var(--dark);
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        header h1 {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
        }

        header p {
            text-align: center;
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 700px;
            margin: 10px auto 0;
        }

        .main-content {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .upload-section {
            background-color: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .upload-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .upload-area {
            border: 2px dashed var(--gray);
            border-radius: 15px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            margin: 20px 0;
            transition: all 0.3s ease;
        }

        .upload-area:hover,
        .upload-area.active {
            border-color: var(--primary);
            background-color: rgba(67, 97, 238, 0.05);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .upload-area h3 {
            font-size: 1.4rem;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .upload-area p {
            color: var(--gray);
            margin-bottom: 15px;
        }

        .file-input {
            display: none;
        }

        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .btn:hover {
            background-color: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(67, 97, 238, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-lg {
            padding: 14px 28px;
            font-size: 1.1rem;
        }

        .btn-block {
            display: block;
            width: 100%;
        }

        .btn:disabled {
            background-color: var(--gray);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .loader-container {
            display: none;
            text-align: center;
            margin-top: 30px;
            padding: 20px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            margin: 0 auto 20px;
            border-radius: 50%;
            border: 4px solid var(--primary);
            border-left-color: rgba(0, 0, 0, 0.1);
            animation: spin 1s linear infinite;
        }

        /* .progress-container {
            width: 100%;
            background-color: var(--light-gray);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        } */

        /* .progress-bar {
            height: 10px;
            background: linear-gradient(to right, var(--primary), var(--success));
            width: 0%;
            border-radius: 10px;
            transition: width 0.5s ease;
            position: relative;
            animation: progress-glow 1.5s ease-in-out infinite;
        } */

        /* @keyframes progress-glow {
            0% {
                box-shadow: 0 0 5px var(--primary);
            }

            50% {
                box-shadow: 0 0 15px var(--success);
            }

            100% {
                box-shadow: 0 0 5px var(--primary);
            }
        } */

        /* .status-text {
            font-size: 1rem;
            color: var(--dark);
            margin: 10px 0;
            font-weight: 500;
            transition: all 0.3s ease;
        } */

        .fun-facts-section {
            margin-top: 40px;
            position: relative;
            height: 100px;
            /* Fixed height for the carousel */
        }

        .fun-facts-section h4 {
            font-size: 1.1rem;
            color: var(--primary);
            margin-bottom: 15px;
            font-weight: 600;
            text-align: center;
        }

        .fun-fact-card {
            position: absolute;
            background: linear-gradient(135deg, white, var(--light));
            border-radius: 12px;
            padding: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transform: translateY(20px) scale(0.9);
            transition: all 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            left: 0;
            right: 0;
            margin: 0 auto;
            text-align: center;
            border-left: 5px solid var(--primary);
        }

        .fun-fact-card.active {
            opacity: 1;
            transform: translateY(0) scale(1);
            z-index: 5;
        }

        .fun-fact-card p {
            font-size: 1.05rem;
            line-height: 1.5;
            color: var(--dark);
        }

        .fun-fact-icon {
            color: var(--primary);
            font-size: 1.2rem;
            margin-right: 8px;
        }

        .file-details {
            background-color: rgba(67, 97, 238, 0.05);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            border: 1px solid rgba(67, 97, 238, 0.2);
        }

        .file-details p {
            margin: 5px 0;
            font-size: 0.9rem;
        }

        .file-name {
            font-weight: 600;
            color: var(--dark);
        }

        /* .percentage-text {
            font-size: 0.9rem;
            color: var(--dark);
            position: absolute;
            right: 10px;
            top: -25px;
            font-weight: 600;
        } */

        .error-message {
            color: var(--danger);
            background-color: rgba(247, 37, 133, 0.1);
            border: 1px solid var(--danger);
            border-radius: 8px;
            padding: 12px;
            margin: 20px 0;
            display: none;
            text-align: center;
        }

        .error-message i {
            margin-right: 8px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        footer {
            text-align: center;
            padding: 30px 0;
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: 50px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2rem;
            }

            .upload-icon {
                font-size: 2.5rem;
            }

            .upload-area h3 {
                font-size: 1.2rem;
            }

            .btn-lg {
                padding: 12px 24px;
                font-size: 1rem;
            }
        }
    </style>
</head>

<body>
    <header>
        <div class="container">
            <h1>Docs2PPT</h1>
            <p>Transform your PDFs into professional PowerPoint presentations with just a few clicks</p>
        </div>
    </header>

    <div class="container">
        <div class="main-content">
            <!-- Upload Section -->
            <section class="upload-section" id="uploadSection">

                <form id="upload-form" action="/upload" method="post" enctype="multipart/form-data">
                    <h2>Upload Your Document</h2>
                    <p>Select a PDF file to convert to PowerPoint presentation</p>

                    <div class="error-message" id="errorMessage">
                        <i class="fa-solid fa-circle-exclamation"></i>
                        <span id="errorText">Please select a valid PDF file before converting.</span>
                    </div>

                    <div class="upload-area" id="dropArea">
                        <i class="fa-solid fa-cloud-arrow-up upload-icon"></i>
                        <h3>Drag & Drop your file here</h3>
                        <p>or</p>
                        <input type="file" id="fileInput" class="file-input" name="file" accept=".pdf,.docx,.doc"
                            required>
                        <button type="button" class="btn" id="browseBtn">Browse Files</button>
                        <p style="margin-top: 15px;">(Please select file under 10MB)</p>
                    </div>

                    <button type="submit" class="btn btn-lg btn-block" id="convertBtn" disabled>Convert to
                        PowerPoint</button>
                </form>

                <div class="loader-container" id="loader">
                    <div class="spinner"></div>
                    <h3>Processing your file... It make take a while.</h3>

                    <div class="file-details" id="fileDetails"
                        style="display: flex; gap:20px; align-items: center; justify-content: center; flex-wrap: wrap;">
                        <p><span class="file-name" id="processingFileName">file.pdf</span></p>
                        <p id="fileSize">Size: Calculating...</p>
                        <p id="pageCount">Pages: Analyzing...</p>
                    </div>

                    <!-- <div class="progress-container">
                        <div class="percentage-text" id="percentageText">0%</div>
                        <div class="progress-bar" id="progressBar"></div>
                    </div> -->

                    <!-- <div class="status-text" id="statusText">Initializing...</div> -->

                    <div class="fun-facts-section">
                        <h4>Did you know?</h4>
                        <div id="funFactsCarousel">
                            <div class="fun-fact-card" id="funFact1">
                                <p><i class="fa-solid fa-lightbulb fun-fact-icon"></i> PowerPoint was first released in
                                    1987 for Macintosh computers.</p>
                            </div>
                            <div class="fun-fact-card" id="funFact2">
                                <p><i class="fa-solid fa-chart-simple fun-fact-icon"></i> The average PowerPoint
                                    presentation has 15-20 slides.</p>
                            </div>
                            <div class="fun-fact-card" id="funFact3">
                                <p><i class="fa-solid fa-globe fun-fact-icon"></i> Over 35 million PowerPoint
                                    presentations are created every day.</p>
                            </div>
                            <div class="fun-fact-card" id="funFact4">
                                <p><i class="fa-solid fa-brain fun-fact-icon"></i> Using visuals can improve learning by
                                    up to 400%.</p>
                            </div>
                            <div class="fun-fact-card" id="funFact5">
                                <p><i class="fa-solid fa-ruler fun-fact-icon"></i> The "10-20-30 rule" suggests 10
                                    slides, 20 minutes, 30pt font.</p>
                            </div>
                            <div class="fun-fact-card" id="funFact6">
                                <p><i class="fa-solid fa-file-pdf fun-fact-icon"></i> The first PDF specification was
                                    published in 1993.</p>
                            </div>
                            <div class="fun-fact-card" id="funFact7">
                                <p><i class="fa-solid fa-puzzle-piece fun-fact-icon"></i> PDF stands for "Portable
                                    Document Format".</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>© 2025 PDF to PowerPoint Converter. All rights reserved.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const form = document.getElementById('upload-form');
            const fileInput = document.getElementById('fileInput');
            const browseBtn = document.getElementById('browseBtn');
            const convertBtn = document.getElementById('convertBtn');
            const loader = document.getElementById('loader');
            const dropArea = document.getElementById('dropArea');
            const errorMessage = document.getElementById('errorMessage');
            const errorText = document.getElementById('errorText');

            // Initially disable the convert button
            convertBtn.disabled = true;

            // Open file browser when the browse button is clicked
            browseBtn.addEventListener('click', function () {
                fileInput.click();
            });

            // Validate the file when selected
            // fileInput.addEventListener('change', function () {
            //     if (fileInput.files.length > 0) {
            //         const file = fileInput.files[0];

            //         if (file.type === 'application/pdf') {
            //             // Valid PDF file
            //             document.querySelector('.upload-area h3').textContent = file.name;
            //             convertBtn.disabled = false;
            //             errorMessage.style.display = 'none';
            //         } else {
            //             // Not a PDF file
            //             document.querySelector('.upload-area h3').textContent = "Invalid file type";
            //             errorText.textContent = "Please select a PDF file only (.pdf)";
            //             errorMessage.style.display = 'block';
            //             convertBtn.disabled = true;
            //         }
            //     } else {
            //         // No file selected
            //         document.querySelector('.upload-area h3').textContent = "Drag & Drop your file here";
            //         convertBtn.disabled = true;
            //     }
            // });

            // // Handle drag and drop
            // ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            //     dropArea.addEventListener(eventName, preventDefaults, false);
            // });

            // function preventDefaults(e) {
            //     e.preventDefault();
            //     e.stopPropagation();
            // }

            // ['dragenter', 'dragover'].forEach(eventName => {
            //     dropArea.addEventListener(eventName, function () {
            //         dropArea.classList.add('active');
            //     }, false);
            // });

            // ['dragleave', 'drop'].forEach(eventName => {
            //     dropArea.addEventListener(eventName, function () {
            //         dropArea.classList.remove('active');
            //     }, false);
            // });

            // dropArea.addEventListener('drop', function (e) {
            //     const dt = e.dataTransfer;
            //     const files = dt.files;

            //     if (files.length > 0) {
            //         if (files[0].type === 'application/pdf') {
            //             // Valid PDF file
            //             fileInput.files = files;
            //             document.querySelector('.upload-area h3').textContent = files[0].name;
            //             convertBtn.disabled = false;
            //             errorMessage.style.display = 'none';
            //         } else {
            //             // Not a PDF file
            //             document.querySelector('.upload-area h3').textContent = "Invalid file type";
            //             errorText.textContent = "Please select a PDF file only (.pdf)";
            //             errorMessage.style.display = 'block';
            //             convertBtn.disabled = true;
            //         }
            //     }
            // }, false);
            fileInput.addEventListener('change', function () {
                if (fileInput.files[0].size > 10485760) {
                    // document.querySelector('.upload-area h3').textContent = "Invalid file type";
                    errorText.textContent = "Please select a file under 10MB";
                    errorMessage.style.display = 'block';
                    convertBtn.disabled = true;
                } else {

                    if (fileInput.files.length > 0) {
                        const file = fileInput.files[0];
                        const allowedTypes = ['application/pdf',
                            'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                            'application/msword'];

                        if (allowedTypes.includes(file.type)) {
                            // Valid file
                            document.querySelector('.upload-area h3').textContent = file.name;
                            convertBtn.disabled = false;
                            errorMessage.style.display = 'none';
                        } else {
                            // Invalid file
                            document.querySelector('.upload-area h3').textContent = "Invalid file type";
                            errorText.textContent = "Please select a PDF or Word file (.pdf, .docx, .doc)";
                            errorMessage.style.display = 'block';
                            convertBtn.disabled = true;
                        }
                    } else {
                        // No file selected
                        document.querySelector('.upload-area h3').textContent = "Drag & Drop your file here";
                        convertBtn.disabled = true;
                    }
                }
            });

            // Drag & Drop events
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                dropArea.addEventListener(eventName, function () {
                    dropArea.classList.add('active');
                }, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                dropArea.addEventListener(eventName, function () {
                    dropArea.classList.remove('active');
                }, false);
            });

            dropArea.addEventListener('drop', function (e) {
                const dt = e.dataTransfer;
                const files = dt.files;

                if (files.length > 0) {
                    const file = files[0];
                    const allowedTypes = ['application/pdf',
                        'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                        'application/msword'];

                    if (allowedTypes.includes(file.type)) {
                        // Valid file
                        fileInput.files = files;
                        document.querySelector('.upload-area h3').textContent = file.name;
                        convertBtn.disabled = false;
                        errorMessage.style.display = 'none';
                    } else {
                        // Invalid file
                        document.querySelector('.upload-area h3').textContent = "Invalid file type";
                        errorText.textContent = "Please select a PDF or Word file (.pdf, .docx, .doc)";
                        errorMessage.style.display = 'block';
                        convertBtn.disabled = true;
                    }
                }
                if (this.files[0].size > 10485760) {
                    alert("The file size should be less than 10MB");
                }
            }, false);


            // Form submission validation
            form.addEventListener('submit', function (e) {
                // if (fileInput.files.length === 0) {
                //     // No file selected
                //     e.preventDefault();
                //     errorText.textContent = "Please select a PDF file before converting";
                //     errorMessage.style.display = 'block';
                //     return false;
                // }

                // if (fileInput.files[0].type !== 'application/pdf') {
                //     // Not a PDF file
                //     e.preventDefault();
                //     errorText.textContent = "Please select a PDF file only (.pdf)";
                //     errorMessage.style.display = 'block';
                //     return false;
                // }
                if (fileInput.files.length === 0) {
                    // No file selected
                    e.preventDefault();
                    errorText.textContent = "Please select a file before converting";
                    errorMessage.style.display = 'block';
                    return false;
                }

                const allowedTypes = [
                    'application/pdf',
                    'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                    'application/msword'
                ];

                if (!allowedTypes.includes(fileInput.files[0].type)) {
                    // Invalid file type
                    e.preventDefault();
                    errorText.textContent = "Please select a valid file: PDF or Word (.pdf, .docx, .doc)";
                    errorMessage.style.display = 'block';
                    return false;
                }

                // All checks passed, show loader
                form.style.display = 'none';
                loader.style.display = 'block';

                // Set file details
                const file = fileInput.files[0];
                document.getElementById('processingFileName').textContent = file.name;
                document.getElementById('fileSize').textContent = `Size: ${formatFileSize(file.size)}`;

                // Simulate PDF page count analysis
                setTimeout(() => {
                    const estimatedPages = Math.floor(file.size / 40000) + Math.floor(Math.random() * 5);
                    document.getElementById('pageCount').textContent = `Pages: ${estimatedPages}`;
                }, 1500);

                // Start the real-time processing simulation
                // startRealTimeProcessing(file);

                // Start the fun facts carousel
                startFunFactsCarousel();
            });

            // Format file size to human-readable format
            function formatFileSize(bytes) {
                if (bytes < 1024) return bytes + ' bytes';
                else if (bytes < 1048576) return (bytes / 1024).toFixed(2) + ' KB';
                else return (bytes / 1048576).toFixed(2) + ' MB';
            }

            // Function to simulate real-time processing with actual task tracking
            // function startRealTimeProcessing(file) {
            //     const progressBar = document.getElementById('progressBar');
            //     const statusText = document.getElementById('statusText');
            //     const percentageText = document.getElementById('percentageText');

            //     // Processing tasks with expected duration percentages
            //     const processingTasks = [
            //         { name: "Initializing...", duration: 5 },
            //         { name: "Analyzing PDF structure...", duration: 15 },
            //         { name: "Extracting text content...", duration: 20 },
            //         { name: "Processing images...", duration: 20 },
            //         { name: "Analyzing layout and formatting...", duration: 10 },
            //         { name: "Identifying headings and sections...", duration: 5 },
            //         { name: "Creating slide templates...", duration: 5 },
            //         { name: "Applying style and formatting...", duration: 10 },
            //         { name: "Generating slide transitions...", duration: 5 },
            //         { name: "Finalizing presentation...", duration: 5 }
            //     ];

            //     let currentTask = 0;
            //     let currentProgress = 0;
            //     let targetProgress = 0;

            //     // Update status to first task
            //     statusText.textContent = processingTasks[0].name;

            //     // Calculate file size factor (larger files take longer)
            //     const sizeFactor = Math.min(1 + (file.size / 10000000), 3);

            //     // Start the processing simulation
            //     const processInterval = setInterval(() => {
            //         // Move to next task when current task is complete
            //         if (currentProgress >= targetProgress) {
            //             currentTask++;

            //             // If all tasks are complete
            //             if (currentTask >= processingTasks.length) {
            //                 clearInterval(processInterval);
            //                 statusText.textContent = "Presentation ready!";
            //                 progressBar.style.width = "100%";
            //                 percentageText.textContent = "100%";

            //                 // Here you would normally handle the redirect to the download page
            //                 // For simulation purposes, we'll just show a success message
            //                 setTimeout(() => {
            //                     statusText.textContent = "Redirecting to download page...";
            //                 }, 1500);

            //                 return;
            //             }

            //             // Update to next task
            //             statusText.textContent = processingTasks[currentTask].name;

            //             // Calculate progress target for next task
            //             targetProgress = 0;
            //             for (let i = 0; i <= currentTask; i++) {
            //                 targetProgress += processingTasks[i].duration;
            //             }
            //         }

            //         // Gradually increase progress toward target
            //         currentProgress += 0.4 * Math.random() * sizeFactor;
            //         currentProgress = Math.min(currentProgress, targetProgress);

            //         // Update progress bar and percentage
            //         const percentageValue = Math.floor(currentProgress);
            //         progressBar.style.width = percentageValue + "%";
            //         percentageText.textContent = percentageValue + "%";
            //     }, 200);
            // }

            // Function to rotate through fun facts with animation
            function startFunFactsCarousel() {
                const funFacts = document.querySelectorAll('.fun-fact-card');
                let currentFactIndex = 0;

                // Show the first fact
                funFacts[0].classList.add('active');

                // Rotate through facts every 6 seconds
                setInterval(() => {
                    // Hide current fact
                    funFacts[currentFactIndex].classList.remove('active');

                    // Move to next fact
                    currentFactIndex = (currentFactIndex + 1) % funFacts.length;

                    // Show next fact
                    funFacts[currentFactIndex].classList.add('active');
                }, 6000);
            }
        });
    </script>


</body>

</html>